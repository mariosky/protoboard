{% extends "activitytree/base.html" %}
{% load gravatar %}
{% load auth_extras %}

{% block content %}


      <div class="bg-primary py-4 py-lg-6">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-xl-12 col-lg-12 col-md-12 col-12">
          <div>
            <h1 class="mb-0 text-white display-4">Filtro de Cursos</h1>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Content -->
  <div class="py-6">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 mb-4">
          <div class="row d-lg-flex justify-content-between align-items-center">
            <div class="col-md-6 col-lg-8 col-xl-9 ">
              <h4 class="mb-3 mb-lg-0"> Mostrando {{courses|length}} de {{count}} cursos</h4>
            </div>
            <div class="d-inline-flex col-md-6 col-lg-4 col-xl-3 ">
              <div class="me-2">
                <!-- Nav -->
                <div class="nav btn-group flex-nowrap" role="tablist">
                  <button class="btn btn-outline-white active"  data-bs-toggle="tab"  data-bs-target="#tabPaneGrid" role="tab"
                    aria-controls="tabPaneGrid" aria-selected="true">
                    <span class="fe fe-grid"></span>
                  </button>
                  <button class="btn btn-outline-white"  data-bs-toggle="tab"  data-bs-target="#tabPaneList" role="tab"
                    aria-controls="tabPaneList" aria-selected="false">
                    <span class="fe fe-list"></span>
                  </button>
                </div>
              </div>
              <!-- List  -->
              <select class="selectpicker" data-width="100%">
                <option value="">Ordena por</option>
                <option value="Newest">Nuevo</option>
                <option value="Free">Precio</option>
                <option value="Most Popular">Popularidad</option>
                <option value="Highest Rated">Mejor evaluado</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-3 col-md-4 col-12 mb-4 mb-lg-0">
          <!-- Card -->
          <div class="card">
            <!-- Card header -->
            <div class="card-header">
              <h4 class="mb-0">Filtro</h4>
            </div>
            <!-- Card body -->
            <div class="card-body">
              <span class="dropdown-header px-0 mb-2"> Etiquetas </span>
              <!-- Checkbox -->
              {% for tag in tags%}
              <div class="custom-control custom-checkbox mb-1">
                <input type="checkbox" class="custom-control-input" id="{{tag.tag}}Check"  value="{{tag.tag}}"  {% if tag.checked %} checked {% endif %}  >
                <label class="custom-control-label" for="{{tag.tag}}Check">{{tag.tag}}</label>
              </div>
              {% endfor %}
               <!-- Checkbox -->
            </div>
            <!-- Card body -->
           {% comment%}
            <div class="card-body border-top">
              <span class="dropdown-header px-0 mb-2"> Rese√±as </span>
              <!-- Custom control -->
              <div class="custom-control custom-radio mb-1">
                <input type="radio" class="custom-control-input" id="starRadio1" name="customRadio">
                <label class="custom-control-label" for="starRadio1">
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star text-warning "></i>
                  <span class="font-size-xs">4.5 & UP</span>
                </label>
              </div>
       
              <!-- Custom control -->
              <div class="custom-control custom-radio mb-1">
                <input type="radio" class="custom-control-input" id="starRadio2" name="customRadio" checked>
                <label class="custom-control-label" for="starRadio2"> <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star text-warning "></i>
                  <span class="font-size-xs">4.0 & UP</span></label>
              </div>
              <!-- Custom control -->
              <div class="custom-control custom-radio mb-1">
                <input type="radio" class="custom-control-input" id="starRadio3" name="customRadio">
                <label class="custom-control-label" for="starRadio3"> <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star text-warning "></i>
                  <span class="font-size-xs">3.5 & UP</span></label>
              </div>
              <!-- Custom control -->
              <div class="custom-control custom-radio mb-1">
                <input type="radio" class="custom-control-input" id="starRadio4" name="customRadio">
                <label class="custom-control-label" for="starRadio4"> <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star me-n1 text-warning"></i>
                  <i class="mdi mdi-star text-warning "></i>
                  <span class="font-size-xs">3.0 & UP</span></label>
              </div>
            </div>
            {% endcomment %}

            <!-- Card body -->
            <div class="card-body border-top">
              <span class="dropdown-header px-0 mb-2"> Dificultad </span>
               <!-- Checkbox -->
              {% for level in levels %}
              <div class="custom-control custom-checkbox mb-1">
                <input type="checkbox" class="custom-control-input" value="{{level.level}}" id="{{level.level}}Check" {% if level.checked %} checked {% endif %} >
                <label class="custom-control-label" for="{{level.level}}Check">{{level.level}}</label>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        <!-- Tab content -->
        <div class="col-xl-9 col-lg-9 col-md-8 col-12">
          <div class="tab-content">
            <!-- Tab pane -->
            <div class="tab-pane fade show active pb-4 " id="tabPaneGrid" role="tabpanel" aria-labelledby="tabPaneGrid">
              <div class="row">

                  {% for c in courses %}
                <div class="col-lg-4 col-md-6 col-12">
                  <!-- Card -->
                  <div class="card  mb-4 card-hover">
                    <a href="/course_info/{{c.id}}" class="card-img-top"><img src="{{ c.metadata.image_url }}" alt=""
                        class="card-img-top rounded-top"></a>
                    <!-- Card body -->
                    <div class="card-body">
                      <h4 class="mb-2 text-truncate-line-2 "><a href="/course_info/{{c.id}}" class="text-inherit">{{c.metadata.title}}</a>
                      </h4>
                       <!-- List inline -->
                      <ul class="mb-3 list-inline">
                        <li class="list-inline-item"><i class="fa fa-clock me-1"></i>
                             {% if c.metadata.duration is not None %}
                                {{c.metadata.duration|duration}}
                            {% endif %}
                        </li>
                        {% if c.metadata.level == "principiante" %}
                        <li class="list-inline-item"><svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16"
                            fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE">
                            </rect>
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#DBD8E9">
                            </rect>
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#DBD8E9">
                            </rect>
                          </svg> Principiante
                        </li>
                        {% endif %}
                        {% if c.metadata.level == 'intermedio'%}
                        <li class="list-inline-item">
                          <svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE" />
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#754FFE" />
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#DBD8E9" />
                          </svg>
                          Intermedio
                        </li>
                        {% endif %}
                        {% if c.metadata.level == 'avanzado'%}
                         <li class="list-inline-item">
                          <svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE" />
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#754FFE" />
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#754FFE" />
                          </svg>
                          Avanzado
                        </li>
                        {% endif %}  

                      </ul>
                    <!--  <div class="lh-1">
                        <span>
                          <i class="mdi mdi-star text-warning me-n1"></i>
                          <i class="mdi mdi-star text-warning me-n1"></i>
                          <i class="mdi mdi-star text-warning me-n1"></i>
                          <i class="mdi mdi-star text-warning me-n1"></i>
                          <i class="mdi mdi-star text-warning"></i>
                        </span>
                        <span class="text-warning">4.5</span>
                        <span class="font-size-xs text-muted">(7,700)</span>
                      </div>-->

                    </div>
                    <!-- Card footer -->
                    <div class="card-footer">
                       <!-- Row -->

                      <div class="row align-items-center g-0">
                        <div class="col-auto">
                          <img src="{{ c.author.authorprofile.image }}" class="rounded-circle avatar-xs" alt="">
                        </div>
                        <div class="col ms-2">
                         <a href="/instructor_info/{{c.author.id}}">
                          <span>{{c.author.first_name }} {{ c.author.last_name }}</span>
                          </a>
                        </div>
                        <div class="col-auto">
                      <!--    <a href="#" class="text-muted bookmark">
                        <i class="fe fe-bookmark  "></i>
                        </a> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}

              </div>
            </div>
            <!-- Tab pane -->
            <div class="tab-pane fade pb-4" id="tabPaneList" role="tabpanel" aria-labelledby="tabPaneList">
              <!-- Card -->
             {% for c in courses %}
              <div class="card mb-4 card-hover">
                 <div class="row g-0">
                           <!-- List inline -->
                    <a class="col-12 col-md-12 col-xl-3 col-lg-3 bg-cover img-left-rounded"
                            style="background-image: url({{ c.metadata.image_url }});" href="/course_info/{{c.root.id}}">
                          {% if c.metadata.image_url %}
                            <img src="{{  c.metadata.image_url }}" alt="..." class="img-fluid d-lg-none invisible">
                          {% endif %}
                    </a>
                    <div class="col-lg-9 col-md-12 col-12">
                    <!-- Card body -->
                    <div class="card-body">
                      <h3 class="mb-2 text-truncate-line-2 "><a href="#" class="text-inherit">{{c.root.name}}</a></h3>
                           <!-- List inline -->
                      <ul class="mb-5 list-inline">
                        <li class="list-inline-item"><i class="fa fa-clock me-1"></i>
                          {% if c.metadata.duration is not None %}
                                {{c.metadata.duration|duration}}
                          {% endif %}
                        </li>
                        {% if c.metadata.level == "principiante" %}
                        <li class="list-inline-item"><svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16"
                            fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE">
                            </rect>
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#DBD8E9">
                            </rect>
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#DBD8E9">
                            </rect>
                          </svg> Principiante
                        </li>
                        {% endif %}
                        {% if c.metadata.level == 'intermedio'%}
                        <li class="list-inline-item">
                          <svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE" />
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#754FFE" />
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#DBD8E9" />
                          </svg>
                          Intermedio
                        </li>
                        {% endif %}
                        {% if c.metadata.level == 'avanzado'%}
                         <li class="list-inline-item">
                          <svg class="me-1 mt-n1" width="16" height="16" viewBox="0 0 16 16" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE" />
                            <rect x="7" y="5" width="2" height="9" rx="1" fill="#754FFE" />
                            <rect x="11" y="2" width="2" height="12" rx="1" fill="#754FFE" />
                          </svg>
                          Avanzado
                        </li>
                        {% endif %}  


                        <!-- <li class="list-inline-item"> <span>
                            <i class="mdi mdi-star text-warning me-n1"></i>
                            <i class="mdi mdi-star text-warning me-n1"></i>
                            <i class="mdi mdi-star text-warning me-n1"></i>
                            <i class="mdi mdi-star text-warning me-n1"></i>
                            <i class="mdi mdi-star text-warning"></i>
                          </span>
                          <span class="text-warning">4.5</span>
                          <span class="font-size-xs text-muted">(9,300)</span></li>-->
                      </ul> 
                       <!-- Row -->
                      <div class="row align-items-center g-0">
                        <div class="col-auto">
                              <img src="{% gravatar_url c.author.email 100 %}" class="rounded-circle avatar-xs" alt="">
                        </div>
                        <div class="col ms-2">
                          <a href="/instructor_info/{{c.author.id}}">
                             <span>{{c.author.first_name }} {{ c.author.last_name }} </span>
                          </a>   
                        </div>
                        <div class="col-auto">
                        <!-- 
                         <a href="#" class="text-muted bookmark">
                            <i class="fe fe-bookmark  "></i>
                          </a>
                        -->
                        </div>
                          </div>
                        <div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
              <!-- Card -->
            {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


{% endblock content %}


  {% block scripts %}
  {{block.super}}
<script> 
  $( document ).ready(function() {

  var countChecked = function() {
    var tags = [];
    var levels = []; 
    $( "input:checked" ).each(function( index) {
      
      var choices = ['principiante', 'intermedio', 'avanzado'];

      if ( choices.includes(this.value)) // is one of the level checkboxes? 
          levels.push(this.value);
      else 
        tags.push(this.value);
      
    });

    console.log(tags);
    console.log(levels);

    query = "?tags=" + tags.join(",")
		if (levels)
				query+= "&levels=" + levels.join(",");

			//location.replace("/search/" + query);
			window.location.href = "/courses/" + query;
      
  //  console.log( n + (n === 1 ? " is" : " are") + " checked!" );
  };

//countChecked();
 
$( "input[type=checkbox]" ).on( "click", countChecked );


});

</script>
  {% endblock scripts %}